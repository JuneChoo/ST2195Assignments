---
title: "Graphs"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

### Load in the libraries and the data

```{r}
library(ggplot2)
library(knitr)


titanic <- read.csv("titanic.csv")

```



```{r}
dim(titanic)

summary(titanic)
```

```{r}
sum(is.na(titanic))

sum(is.na(titanic$Age))

sapply(titanic, function(x) sum(is.na(x)))


```

```{r}
titanic[which(titanic$Embarked ==''), ]
```


```{r}



titanic$Survived <- as.factor(titanic$Survived)


titanic$Sex <- as.factor(titanic$Sex)

titanic$Embarked <-as.factor(titanic$Embarked)

```




### Q1 Bar charts

```{r}
ggplot(titanic, aes(x = Sex, fill=Survived))  + geom_bar() + xlab('Gender')+ggtitle( "Gender of the passengers onboard" ) +ylab('Number') 
```









```{r}
ggplot(titanic, aes(x = Sex, fill=Survived)) + geom_bar(fill = c("yellow", 'black')) + xlab('Gender')+ggtitle( "Gender of the passengers onboard" ) +ylab('Number') 



```









#### a. Gender of the passengers onboard
```{r}
ggplot(titanic, aes(x = Sex, fill = Sex)) + 
  geom_bar() + 
  labs(title = "Gender of the passengers onboard")
```

#### b. Ticket class of the passengers onboard

```{r}
ggplot(titanic, aes(x = Pclass, fill = Pclass)) + 
    geom_bar() + 
    ggtitle("Ticket class of the passengers onboard") + 
    xlab("ticket class") +
    theme(legend.position="none")
```

```{r}
library(dplyr)
titanic %>%
  mutate(Pclass = factor(x = Pclass, levels = c(1,2,3), labels = c("1st", "2nd", "3rd"))) %>%
  ggplot(aes(x = Pclass, fill = Pclass)) + 
    geom_bar() + 
    ggtitle("Ticket class of the passengers onboard") + 
    xlab("ticket class") +
    theme(legend.position="none")

```

#### c. Survival of the passengers onboard
```{r} 
titanic %>%
  mutate(Survived = factor(x = Survived, levels = c(0,1), labels = c("No", "Yes"))) %>%
  ggplot(aes(x = Survived, fill = Survived)) + 
    geom_bar() + 
    ggtitle("Survival of the passengers onboard") + 
    theme(legend.position="none")
```

### Q2 Age of the passengers onboard

#### a. Histogram 

```{r}
summary(titanic )
```

```{r}
ggplot(titanic) + aes(x = Age) + geom_histogram(bins=10)

```



```{r}
ggplot(titanic, aes(x = Age, y=..density..)) + 
  geom_histogram(fill = "steelblue", bins = 10, na.rm = TRUE) + ggtitle("Distribution of age of the passengers onboard") 
```

#### b. Boxplot (group by ticket class)


```{r}
ggplot(titanic, aes(x = as.factor(Pclass), y = Age)) + 
  geom_boxplot()  
```

```{r}
titanic %>%
  mutate(Pclass = factor(x = Pclass, levels = c(1,2,3), labels = c("1st", "2nd", "3rd"))) %>%
ggplot(aes(x = Pclass, y = Age, fill = Pclass)) + 
  geom_boxplot(na.rm = TRUE) + 
  ggtitle("Age of the passengers onboard") + 
  xlab("ticket class") + 
  theme(legend.position="none")
```

















#### c. Boxplot (group by survival)

```{r}
titanic %>%
  mutate(Survived = factor(x = Survived, levels = c(0,1), labels = c("No", "Yes")))  
```


```{r}
ggplot(titanic, aes(x = as.factor(Survived), y = Age)) + 
  geom_boxplot()  + scale_x_discrete(name = 'Survived', labels=c('0' = 'no', '1' =  'yes'))
```



```{r}
titanic %>%
  mutate(Survived = factor(x = Survived, levels = c(0,1), labels = c("No", "Yes")))  %>%
  ggplot(aes(x = Survived, y = Age, fill = Survived)) + 
    geom_boxplot(na.rm = TRUE) + 
    ggtitle("Age of the passengers onboard") + 
    theme(legend.position="none")
```

```{r}
ggplot(titanic) + geom_boxplot(aes(x = Age, fill = as.factor(titanic$Survived))) +
    labs(title = "Box plot of age based on survival", x = "Age")
```






### Q3 Ticket fare of the passengers onboard


```{r}
ggplot(titanic, aes(x = Fare)) + 
  geom_histogram(fill = "steelblue", bins =15) + 
  ggtitle("Ticket fare of the passengers onboard") 
```



```{r}

library(scales)

ggplot(titanic, aes(x = Fare, y= ..density..)) + geom_histogram(bins=5)

ggplot(titanic, aes(Fare)) + geom_histogram(aes(y = ..count..), bins=5) 

ggplot(titanic, aes(x =Fare)) +  geom_histogram(aes(y = (..count..)/sum(..count..)), bins=5) + scale_y_continuous(labels=percent)




```


```{r}
sum(titanic$Fare == 0)
```


```{r}
library(dplyr)
fare <- select(titanic, "Fare", "Name")
fare <- filter(fare,Fare == 0)
dim(fare)
```

```{r}
paid_table <- table(titanic$Fare != 0)
names(paid_table) <- c("not pay", "paid")
paid_table
```

### Q4 Family size per ticket class

```{r}
ggplot(titanic, aes(x = SibSp)) +
  geom_histogram(bins = 11) +
  facet_grid(Pclass ~ ., scales = "free")
```

```{r}
titanic %>%
  mutate(Pclass = factor(x = Pclass, levels = c(1,2,3), labels = c("1st", "2nd", "3rd"))) %>%
  ggplot(aes(x = family_size, y = ..density.., fill = Pclass)) +
  geom_histogram(bins = 11) +
  facet_grid(Pclass ~ ., scales = "free")  + 
  guides(fill=FALSE) +
  ggtitle("Family size per ticket class")
```


```{r}
ggplot(titanic,aes(x = family_size, y = ..density..)) +geom_histogram(bins = 11) 
```



### Q5 Stacked bar charts to describe the survival rate per gender and ticket class

#### Survival rate per gender

```{r}
titanic %>%
    mutate(Survived = factor(x = Survived, levels = c(0,1), labels = c("No", "Yes"))) %>%
    ggplot(aes(fill = Survived, x = Sex)) + 
    geom_bar(position ="stack") +
    ggtitle("Survival by gender") + 
    xlab("gender") + 
    guides(fill=guide_legend("survival"))
```

#### Survival rate per ticket class

```{r}
titanic %>%
    mutate(Survived = factor(x = Survived, levels = c(0,1), labels = c("No", "Yes"))) %>%
    mutate(Pclass = factor(x = Pclass, levels = c(1,2,3), labels = c("1st", "2nd", "3rd"))) %>%
    ggplot(aes(fill = Survived, x = Pclass)) + 
    geom_bar(position ="stack") +
    ggtitle("Survival by ticket class") + 
    xlab("ticket class") + 
    guides(fill=guide_legend("survival"))
```

### Q6. Violin chart describing the survival rate per age and gender 

```{r}
ggplot(titanic, aes(x = Sex, y = Age, fill = as.factor(titanic$Survived))) +  geom_violin() +geom_boxplot()
```

```{r}
titanic %>%
  mutate(Survived = factor(x = Survived, levels = c(0,1), labels = c("No", "Yes"))) %>%
  ggplot(aes(x = Sex, y = Age, fill = Survived)) + 
    geom_violin() +geom_boxplot(width=0.5)
```


```{r}
violin1 <- ggplot(titanic)+aes( y = Age, x = Sex, fill = Sex)+ geom_violin()+
   theme_light()+ facet_grid(~Survived)
  labs ( title = "Survival relation to age and gender", y = "Age" , x = "Gender")
violin1
```

### Q7. Violin chart describing the survival rate per age and ticket class

```{r}
titanic %>%
  mutate(Survived = factor(x = Survived, levels = c(0,1), labels = c("No", "Yes"))) %>%
  mutate(Pclass = factor(x = Pclass, levels = c(1,2,3), labels = c("1st", "2nd", "3rd"))) %>%
  ggplot(aes(x = Pclass, y = Age, fill = Survived)) + 
    geom_violin(na.rm = TRUE, adjust = 0.5) + 
    xlab("ticket class")
```



```{r}
titanic %>%
  mutate(Survived = factor(x = Survived, levels = c(0,1), labels = c("No", "Yes"))) %>%
  mutate(Pclass = factor(x = Pclass, levels = c(1,2,3), labels = c("1st", "2nd", "3rd"))) %>%
  ggplot(aes(x = Pclass, y = Age, fill = Survived)) + 
    geom_violin(na.rm = TRUE, adjust = 0.5) + 
    xlab("ticket class")
```


```{r}
violin1 <- ggplot(titanic)+aes( y = Age, x = as.factor(Pclass))+ geom_violin()+
   theme_light()+ facet_grid(~Survived)
  labs ( title = "Survival relation to age and gender", y = "Age" , x = "")
violin1
```



